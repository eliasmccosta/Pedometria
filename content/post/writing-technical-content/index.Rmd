---
date: "2020-05-15"
diagram: true
image:
  caption: 'Image credit: [**Elias**](https://www.instagram.com/eliasmendescosta/)'
  focal_point: ""
  placement: 3
math: true
title: Amostragem para mapeamento 
subtitle: 'Amostragem para mapeamento digital de solos: Um tutorial em R'
summary: ''
bibliography: [references.bib]
link-citations: true 
csl: [geoderma-regional.csl]
authors:
- admin
categories:
  - R
tags:
  - MDS
nocite: | 
  @R-bookdown
---

```{r, eval=FALSE, echo=FALSE}
rmarkdown::render('index.Rmd', encoding = 'UTF-8'")
```

# IntroduÃ§Ã£o
## Conceitos bÃ¡sicos e terminologias
A *amostragem* diz respeito Ã  seleÃ§Ã£o de um subconjunto de indivÃ­duos de uma populaÃ§Ã£o para estimar caracterÃ­sticas de toda a populaÃ§Ã£o [@Wang2012a]. Ou A amostragem pode ser definida como selecÃ§Ã£o de partes de um universo finito, com a proposta de obter informaÃ§Ãµes desse universo [@deGruijter2006]. A *amostra* pode ser definida como a parte coletada, e levada para laboratÃ³rio, ou observada *in situ*.  E uma Ãºnica parte dessa amostra pode ser  definida como *unidade amostral*, o nÃºmero de unidades amostrais Ã© definido como *tamanho amostral* ou *n amostral* [@deGruijter2006]. 
Uma confusÃ£o comum na literatura Ã© sobre a definiÃ§Ã£o de amostragem aletÃ³ria e amostragem arbitrÃ¡ria ou casual [@Brus2019] no segundo caso os locais de amostragem sÃ£o escolhidos, fundamentalmente, em funÃ§Ã£o da subjetividade da pessoa conduzindo o ntraballho. Para evitar a confusÃ£o o termo *amostragem probabilÃ­stica* deve ser priorizado para o as amostras aleatÃ³rias. A amostragem de probabilidade Ã© uma amostragem aleatÃ³ria que atende a dois requisitos. Em primeiro lugar, todas as unidades da populaÃ§Ã£o tÃªm uma probabilidade positiva de serem selecionadas. Nenhuma parte da populaÃ§Ã£o pode ser excluÃ­da. Em segundo lugar, a probabilidade de seleÃ§Ã£o de cada amostra possÃ­vel Ã© conhecida. Com amostragem arbitrÃ¡ria (casual), esses dois requisitos geralmente nÃ£o sÃ£o atendidos [@Brus2019].


## Amostragem no mapeamento convencional de solos
No caso do mapeamento convencional de solos, o mÃ©todo de prospecÃ§Ã£o e a frequÃªncia de amostragem dependem do nÃ­vel de detalhe do levantamento e do objetivo do levantamento [@IBGE2015]. Por exemplo, na terceira ediÃ§Ã£o do Manual TÃ©cnico de Pedologia [@IBGE2015] o mÃ©todo de prospecÃ§Ã£o indicado para levantamento exploratÃ³rio Ã© o de extrapolaÃ§Ã£o, generalizaÃ§Ãµes, correlaÃ§Ãµes e poucas observaÃ§Ãµes de campo, com uma frequÃªncia de amostragem de um perfil completo por classe de solo predominante na associaÃ§Ã£o. Para o levantamento semidetalhado a densidade de observaÃ§Ãµes e a frequÃªncia de amostragem sÃ£o calculadas em funÃ§Ã£o da heterogeneidade da Ã¡rea e da facilidade de correlaÃ§Ã£o de solos e a superfÃ­cie geomorfolÃ³gicas. No entanto, Ã© recomendada uma mÃ©dia de 0,002 a 0,20 observaÃ§Ãµes por hectare e um perfil completo e um complementar por classe de solo componente da unidade de mapeamento simples ou associaÃ§Ã£o. 
PorÃ©m para o MDS esse esquema de amostragem nÃ£o se aplica, pois nÃ£o fornece estimativa estatÃ­stica representativa. No MDS Ã© necessÃ¡rio o uso de estratÃ©gias de amostragem estatisticamente robustas para diminuir a subjetividade e consequentemente os possÃ­veis erros na prediÃ§Ã£o [@Minasny2007b]

## Amostragem no mapeamento digital de solos
No caso do mapeamento digital de solos (MDS) a amostragem Ã© um fator crucial, pois pode contribuir para elevar ou diminuir os custos do levantamento de solos. Ainda Ã© considera uma das etapas mais importantes para o MDS [@CarvalhoJunior2014]. Para o MDS, para uma otimizaÃ§Ã£o da calibraÃ§Ã£o de modelos matemÃ¡ticos as amostras coletadas devem representar ao mÃ¡ximo a distribuiÃ§Ã£o espacial do que estÃ¡ sendo modelado (atributo ou classe de solo), por isso tÃ©cnicas como o Hipercubo Latino Condicionado (cLHS) [@Minasny2006] sÃ£o frequentemente usados nessa etapa e para essa finalidade. Esse tipo de amostragem Ã© conhecido como amostragem nÃ£o probabilÃ­stica e serÃ¡ abordado com mais detalhes nos exemplos. 
Para validaÃ§Ã£o dos resultados das prediÃ§Ãµes espaciais no MDS o tipo de abordagem recomendado Ã© a amostragem probabilÃ­stica [@BrusEtAl2011], esse tipo de amostragem busca a imparcialidade e diminuiÃ§Ã£o de viÃ©s para validaÃ§Ã£o dos produtos do mapeamento.  AtenÃ§Ã£o especial deve ser tomada nessa etapa, pois nem sempre Ã© possÃ­vel uma amostragem completamente probabilÃ­stica (aleatÃ³ria). HÃ¡ entÃ£o a necessidade de encontrar a condiÃ§Ã£o perfeita do que Ã© factÃ­vel e o ideal. Exemplos de amostragem probabilÃ­stica serÃ£o abordados com mais detalhe nos exemplos.  
Parte do material aqui desenvolvido foi extraÃ­do e adaptado do livro em desenvolvimento de Alessandro Samuel-Rosa, [pedometria feita simples](http://samuel-rosa.github.io/pedometria-feita-simples/principios-da-amostragem-espacial.html). O capÃ­tulo 7 do livro trata de princÃ­pios da amostragem espacial. TambÃ©m foram extraÃ­das informaÃ§Ãµes a respeito de amostragem para validaÃ§Ã£o de mapas digitais de solos [@BrusEtAl2011] e amostragem para mapeamento de solos [@Brus2019]. Assim objetivo desse tutorial e compilar as informaÃ§Ãµes dos trabalhos mencionados para simular difentes estratÃ©gias amostrais para dar suporte aos levantamentos de solos com foco em MDS e avaliaÃ§Ã£o dos produtos gerados. 


# Ãrea experimental e base dados
## Ãrea experimental
Ao longo desse tutorial sobre amostragem, vocÃª verÃ¡ exemplos de cada tipo de amostragem implementados no R usando o conjunto de dados de um Ã¡rea experimental localizada no municÃ­pio de SeropÃ©dica, estado do Rio de Janeiro, Brasil, nas coordenadas geogrÃ¡ficas centrais aproximadas 22Âº54â€™00â€ S e  43Âº55â€™00â€ W (Figura \@ref(fig:localizacao1)). 
```{r localizacao1, echo=FALSE,message=FALSE, warning=FALSE, fig.cap= "Mapa de localizaÃ§Ã£o do municÃ­pio de SeropÃ©dica-RJ. Fonte: Nascimento (2019)",fig.align='center', dpi=80, fig.asp=1}
knitr::include_graphics("localizacao1.png")
```

Especificamente, o trabalho foi desenvolvido na Fazendinha AgroecolÃ³gica km 47 (Sistema Integrado de ProduÃ§Ã£o AgroecolÃ³gica - SIPA), associada Ã  Embrapa Agrobiologia, Empresa de Pesquisa AgropecuÃ¡ria do Estado do Rio de Janeiro (Pesagro-Rio) e Universidade Federal Rural do Rio de Janeiro, nas coordenadas geogrÃ¡ficas centrais aproximadas 22Âº45â€™0â€ S e 43Âº40â€™30â€ W (Figura \@ref(fig:localizacao2)). 
```{r localizacao2, echo=FALSE,message=FALSE, warning=FALSE, fig.cap= "Mapa de localizaÃ§Ã£o da Ã¡rea de estudo em SeropÃ©dica-RJ. Fonte: Nascimento (2019)",fig.align='center', dpi=120, fig.asp=1}
knitr::include_graphics("localizacao2.png")
```

O clima do municÃ­pio caracteriza-se por ser do tipo Aw (Tropical com inverno seco), segundo a classificaÃ§Ã£o de KÃ¶ppen. SeropÃ©dica tem uma temperatura mÃ©dia de 23,5 Â°C e uma pluviosidade mÃ©dia anual de 1354 mm. Os maiores valores de precipitaÃ§Ã£o sÃ£o verificados nos meses de novembro a janeiro e os menores no perÃ­odo entre maio e agosto [@Oliveira-J2014]. A Ã¡rea dos exemplos encontra-se ocupada por pastagem e caracteriza-se por apresentar relevo suave-ondulado a ondulado, altitude entre 17 a 50 m sobre o nÃ­vel do mar, e ausÃªncia de rochosidade e pedregosidade em superfÃ­cie [@Nascimento2019].

Os Solos da Ã¡rea experimental sÃ£o caraterizados por apresentar, no geral baixa fertilidade e elevado grau de desonvilvimento com fatores e processos de formaÃ§Ã£o especÃ­ficos e dominates para cada ordem e posiÃ§Ã£o da paisagem. Para o trabalho de onde os dados derivam [@Nascimento2019], foram abertas 10 trincheiras em diferentes pontos da paisagem, onde foram descritos e classificados perfis do solo, sendo uma trincheira no topo (P10), duas na posiÃ§Ã£o de terÃ§o mÃ©dio (P3 e P9), uma no terÃ§o inferior (P8), trÃªs no sopÃ© da vertente (P2, P5 e P7) e trÃªs na Ã¡rea de baixada (P1, P4 e P6). Os solos froam classificados respectivamente como Argissolos Vermelhos P10, P9 e P3; Argissolo Amarelo, P8; Planossolos HÃ¡plicos (arÃªnicos e espessarenicos), P7,P2,P5; Planossolos HÃ¡plicos (gleissÃ³licos), P4, P6 e Cambissolo HÃ¡lico (com evidente processos de gleizaÃ§Ã£o) P1 (Figura \@ref(fig:localizacao2)). 

## Base de dados (CovariÃ¡veis ambientais)
As covariÃ¡veis ambientais para modelar as propriedades do solo foram derivadas de duas fontes de dados: modelo digital de elevaÃ§Ã£o, dados de sensoriamento remoto (imagem orbital), uma imagem RapidEye. Elas foram escolhidos para descrever os principais fatores formadores do solo, de acordo com a abordagem scorpan [@McBratneyEtAl2003].

*Modelo Digital de ElevaÃ§Ã£o (MDE)*: O MDE utilizado, com resoluÃ§Ã£o espacial de 2 m, foi gerado a partir das curvas de nÃ­vel e pontos cotados coeletados com gps geodÃ©sico. Do MDE foram derivados 12 atributos de terreno com pontencial uso para modelagem no MDS. 

*Imagem de satÃ©lite*: foram utilizadas duas cenas do sensor RapidEyeambas de 2011. As duas cenas foram usadas para cobrir toda a Ã¡rea de estudo e eles tÃªm uma 12 resoluÃ§Ã£o radiomÃ©trica de bits, resoluÃ§Ã£o espacial de 6,5m, e ortorretificadas para resoluÃ§Ã£o espacial de 5m [@RapidEye2012].
Das cenas foram derivados os indices de vegetaÃ§Ã£o (NDVI, inglÃªs) e Ã­ndice de vegetaÃ§Ã£o ajustado ao solo (SAVI, inglÃªs).

## Ãreas ambientalmente homogÃªneas (Estratos)
Para fazer o exerÃ­cio foram criadas Ã¡reas ambientalmente similares (homogÃªneas), essa a bordagem Ã© indicada em casos onde hÃ¡ por exemplo o interesse de fazer a amostragem po estratos. Nesse execÃ­cio optou-se por criar 10 estratos usando as variÃ¡veis, que julgamos serem as mais representativas para discretizar os ambientes. Foram elas elevaÃ§Ã£o, declividade e SAVI. Para fazer o agrupamento da Ã¡reas de maior similaridade (criaÃ§Ã£o de clusters) foi utilizado o algorÃ­timo de classificaÃ§Ã£o nÃ£o supervisionada *K-Means Clustering* que visa particionar os pontos em k grupos de forma que a soma dos quadrados dos pontos aos centros de cluster designados seja minimizada. No mÃ­nimo, todos os centros do cluster estÃ£o na mÃ©dia dos seus conjuntos de Voronoi (o conjunto de pontos de dados que estÃ£o mais prÃ³ximos do centro do cluster).
































Academic is designed to give technical content creators a seamless experience. You can focus on the content and Academic handles the rest.

**Highlight your code snippets, take notes on math classes, and draw diagrams from textual representation.**

On this page, you'll find some examples of the types of technical content that can be rendered with Academic.

## Examples

### Code
A *amostragem* diz respeito Ã  seleÃ§Ã£o de um subconjunto de indivÃ­duos de uma populaÃ§Ã£o para estimar caracterÃ­sticas de toda a populaÃ§Ã£o @Wang2012a
Academic supports a Markdown extension for highlighting code syntax. You can enable this feature by toggling the `highlight` option in your `config/_default/params.toml` file.

    ```python
    import pandas as pd
    data = pd.read_csv("data.csv")
    data.head()
    ```

renders as

```python
import pandas as pd
data = pd.read_csv("data.csv")
data.head()
```

### Math

Academic supports a Markdown extension for $\LaTeX$ math. You can enable this feature by toggling the `math` option in your `config/_default/params.toml` file.

To render *inline* or *block* math, wrap your LaTeX math with `$...$` or `$$...$$`, respectively.

Example **math block**:

```tex
$$\gamma_{n} = \frac{ 
\left | \left (\mathbf x_{n} - \mathbf x_{n-1} \right )^T 
\left [\nabla F (\mathbf x_{n}) - \nabla F (\mathbf x_{n-1}) \right ] \right |}
{\left \|\nabla F(\mathbf{x}_{n}) - \nabla F(\mathbf{x}_{n-1}) \right \|^2}$$
```

renders as

$$\gamma_{n} = \frac{ \left | \left (\mathbf x_{n} - \mathbf x_{n-1} \right )^T \left [\nabla F (\mathbf x_{n}) - \nabla F (\mathbf x_{n-1}) \right ] \right |}{\left \|\nabla F(\mathbf{x}_{n}) - \nabla F(\mathbf{x}_{n-1}) \right \|^2}$$

Example **inline math** `$\nabla F(\mathbf{x}_{n})$` renders as $\nabla F(\mathbf{x}_{n})$.

Example **multi-line math** using the `\\\\` math linebreak:

```tex
$$f(k;p_0^*) = \begin{cases} p_0^* & \text{if }k=1, \\\\
1-p_0^* & \text {if }k=0.\end{cases}$$
```

renders as

$$f(k;p_0^*) = \begin{cases} p_0^* & \text{if }k=1, \\\\
1-p_0^* & \text {if }k=0.\end{cases}$$

### Diagrams

Academic supports a Markdown extension for diagrams. You can enable this feature by toggling the `diagram` option in your `config/_default/params.toml` file or by adding `diagram: true` to your page front matter.

An example **flowchart**:

    ```mermaid
    graph TD
    A[Hard] -->|Text| B(Round)
    B --> C{Decision}
    C -->|One| D[Result 1]
    C -->|Two| E[Result 2]
    ```

renders as

```mermaid
graph TD
A[Hard] -->|Text| B(Round)
B --> C{Decision}
C -->|One| D[Result 1]
C -->|Two| E[Result 2]
```

An example **sequence diagram**:

    ```mermaid
    sequenceDiagram
    Alice->>John: Hello John, how are you?
    loop Healthcheck
        John->>John: Fight against hypochondria
    end
    Note right of John: Rational thoughts!
    John-->>Alice: Great!
    John->>Bob: How about you?
    Bob-->>John: Jolly good!
    ```

renders as

```mermaid
sequenceDiagram
Alice->>John: Hello John, how are you?
loop Healthcheck
    John->>John: Fight against hypochondria
end
Note right of John: Rational thoughts!
John-->>Alice: Great!
John->>Bob: How about you?
Bob-->>John: Jolly good!
```

An example **Gantt diagram**:

    ```mermaid
    gantt
    section Section
    Completed :done,    des1, 2014-01-06,2014-01-08
    Active        :active,  des2, 2014-01-07, 3d
    Parallel 1   :         des3, after des1, 1d
    Parallel 2   :         des4, after des1, 1d
    Parallel 3   :         des5, after des3, 1d
    Parallel 4   :         des6, after des4, 1d
    ```

renders as

```mermaid
gantt
section Section
Completed :done,    des1, 2014-01-06,2014-01-08
Active        :active,  des2, 2014-01-07, 3d
Parallel 1   :         des3, after des1, 1d
Parallel 2   :         des4, after des1, 1d
Parallel 3   :         des5, after des3, 1d
Parallel 4   :         des6, after des4, 1d
```

An example **class diagram**:

    ```mermaid
    classDiagram
    Class01 <|-- AveryLongClass : Cool
    <<interface>> Class01
    Class09 --> C2 : Where am i?
    Class09 --* C3
    Class09 --|> Class07
    Class07 : equals()
    Class07 : Object[] elementData
    Class01 : size()
    Class01 : int chimp
    Class01 : int gorilla
    class Class10 {
      <<service>>
      int id
      size()
    }
    ```

renders as

```mermaid
classDiagram
Class01 <|-- AveryLongClass : Cool
<<interface>> Class01
Class09 --> C2 : Where am i?
Class09 --* C3
Class09 --|> Class07
Class07 : equals()
Class07 : Object[] elementData
Class01 : size()
Class01 : int chimp
Class01 : int gorilla
class Class10 {
  <<service>>
  int id
  size()
}
```

An example **state diagram**:

    ```mermaid
    stateDiagram
    [*] --> Still
    Still --> [*]
    Still --> Moving
    Moving --> Still
    Moving --> Crash
    Crash --> [*]
    ```

renders as

```mermaid
stateDiagram
[*] --> Still
Still --> [*]
Still --> Moving
Moving --> Still
Moving --> Crash
Crash --> [*]
```

### Todo lists

You can even write your todo lists in Academic too:

```markdown
- [x] Write math example
- [x] Write diagram example
- [ ] Do something else
```

renders as

- [x] Write math example
- [x] Write diagram example
- [ ] Do something else

### Tables

Represent your data in tables:

```markdown
| First Header  | Second Header |
| ------------- | ------------- |
| Content Cell  | Content Cell  |
| Content Cell  | Content Cell  |
```

renders as

| First Header  | Second Header |
| ------------- | ------------- |
| Content Cell  | Content Cell  |
| Content Cell  | Content Cell  |

### Asides

Academic supports a [shortcode for asides](https://sourcethemes.com/academic/docs/writing-markdown-latex/#alerts), also referred to as *notices*, *hints*, or *alerts*. By wrapping a paragraph in `{{%/* alert note */%}} ... {{%/* /alert */%}}`, it will render as an aside.

```markdown
{{%/* alert note */%}}
A Markdown aside is useful for displaying notices, hints, or definitions to your readers.
{{%/* /alert */%}}
```

renders as

{{% alert note %}}
A Markdown aside is useful for displaying notices, hints, or definitions to your readers.
{{% /alert %}}

### Icons

Academic enables you to use a wide range of [icons from _Font Awesome_ and _Academicons_](https://sourcethemes.com/academic/docs/page-builder/#icons) in addition to [emojis](https://sourcethemes.com/academic/docs/writing-markdown-latex/#emojis).

Here are some examples using the `icon` shortcode to render icons:

```markdown
{{</* icon name="terminal" pack="fas" */>}} Terminal  
{{</* icon name="python" pack="fab" */>}} Python  
{{</* icon name="r-project" pack="fab" */>}} R
```

renders as

{{< icon name="terminal" pack="fas" >}} Terminal  
{{< icon name="python" pack="fab" >}} Python  
{{< icon name="r-project" pack="fab" >}} R

### Did you find this page helpful? Consider sharing it ðŸ™Œ

# ReferÃªncias
